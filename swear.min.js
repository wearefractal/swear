(function(){var e,t,n=[].slice;e=function(e){return typeof process!="undefined"&&process!==null?process.nextTick(e):setTimeout(e,0)},t=function(){var t;return t={efns:[],fns:[],completed:!1,wrap:function(){return function(){var e,r;return r=arguments[0],e=2>arguments.length?[]:n.call(arguments,1),r!=null?t.abort(r):t.resolve.apply(t,e)}},resolve:function(){var e,r,i,s,o;r=1>arguments.length?[]:n.call(arguments,0),t.val=r,t.completed=!0,o=t.fns;for(i=0,s=o.length;i<s;i++)e=o[i],e.apply(null,r);return t},abort:function(e){var n,r,i,s;t.err=e,t.completed=!0,s=t.efns;for(r=0,i=s.length;r<i;r++)n=s[r],n(e);return t},fail:function(n){return t.err?e(function(){return n(t.err)}):t.efns.push(n),t},when:function(n){return t.val?e(function(){return n.apply(null,t.val)}):t.fns.push(n),t}}},t.join=function(){var e,r,i,s,o,u,a;o=1>arguments.length?[]:n.call(arguments,0),e=[],i=t(),r=function(){var t,s;return t=1>arguments.length?[]:n.call(arguments,0),s=o.pop(),s?s.when(function(){var t;return t=1>arguments.length?[]:n.call(arguments,0),e.push(t),r.apply(null,t)}):i.resolve.apply(i,e)};for(u=0,a=o.length;u<a;u++)s=o[u],s.fail(i.abort);return r(),i},typeof module!="undefined"&&module!==null?module.exports=t:window.swear=t}).call(this);